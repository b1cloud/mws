Fork from https://github.com/brickfox/mws with fixes & improvements
